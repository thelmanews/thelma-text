<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../thelma-core/thelma_core.html">
<link rel="import" href="th-flipbox.html">

<polymer-element name="th-flipboard" extends="th-animated" attributes="width height itemsPerRow items flippable">

  <template>
      <core-style ref="theme"></core-style>
      <style>
        :host {
          width: {{width + "px"}};
          height: {{height + "px"}};
        }

        ul {
          list-style: none;
          position: relative;
          padding: 0;
          margin: 0;
          /*width: 100%;*/
          -webkit-margin-before: 0;
          -webkit-margin-after: 0;
        }

        li {
          /*display: table;*/
          position: relative;
          float: left;
          display: inline-block;
          cursor: pointer;
          list-style: none;
          margin: 2px;
          /*background-size: 100%;*/
          overflow: hidden;
          /*height: {{itemHeight + "px"}}; /* subtract margins */*/
          /*width: {{ itemWidth + "px"}}; /* subtract margins */*/
        }

        li > p {
          vertical-align: middle;
          display: table-cell;
          text-align: center;
          margin: 0;
          -webkit-margin-before: 0;
          -webkit-margin-after: 0;
        }

      </style>

      <!-- Inline styles are for Safari and mobile support --> 
        <div id="container" style="width: {{width}}px; height: {{height}}px;">
          <ul>
            <template repeat="{{item, itemIndex in items}}">
              <li>
                <th-flipbox width="{{itemWidth}}" height="{{itemHeight}}" index="{{itemIndex+1}}" flippable="{{flippable}}">
                  
                  <!-- Front side -->
                  <!-- display: table allows for aligning texting in the middle vertically. 
                       it also causes problems in safari regarding widths and heights... --> 
                  <div class="front" 

                  style="background: {{item.backgroundFront}} no-repeat; 
                         display: table;
                         padding: 10px;
                         box-sizing: border-box;
                         position: absolute;
                         width: 100%;
                         height: 100%;
                         -webkit-backface-visibility: hidden;">
                    <p style="color: {{item.colorFront}}; 
                              vertical-align: middle; 
                              display: table-cell; 
                              text-align: center; 
                              -webkit-margin-before: 0; 
                              -webkit-margin-after: 0; 
                              box-sizing: border-box;">
                        {{item.textFront}}
                    </p>
                  </div>
                  
                  <!-- Back side -->
                  <div class="back" 
                  style="background: {{item.backgroundBack}} no-repeat; 
                         display: table;
                         padding: 10px;
                         box-sizing: border-box;
                         position: absolute;
                         width: 100%;
                         height: 100%;
                         -webkit-transform: rotateY( 180deg );
                         -webkit-backface-visibility: hidden;">
                    <p style="color: {{item.colorBack}}; 
                              vertical-align: middle; 
                              display: table-cell; 
                              text-align: center;  
                              -webkit-margin-before: 0;
                              -webkit-margin-after: 0; 
                              box-sizing: border-box;">
                        {{item.textBack}}
                    </p>
                  </div>

                </th-flipbox>
              </li>
            </template>
          </ul>
        </div>

  </template>
  <link rel="import" href="dependencies/web_animations.html">
  <script>

      Polymer('th-flipboard', {
        items: [  {textFront: "front", backgroundFront: "#0198E1", colorFront:"", 
                  textBack: "back", backgroundBack: "#0198E1", colorBack:""},
                  {textFront: "front", backgroundFront: "#0198E1", colorFront:"", 
                  textBack: "back", backgroundBack: "#0198E1", colorBack:""},
                  {textFront: "front", backgroundFront: "#0198E1", colorFront:"", 
                  textBack: "back", backgroundBack: "#0198E1", colorBack:""},
                  {textFront: "front", backgroundFront: "#0198E1", colorFront:"", 
                  textBack: "back", backgroundBack: "#0198E1", colorBack:""}
                 
                ],
        itemsPerRow: 2,
        flippable: true,
        ready: function(){
          var self = this;
          self.itemWidth = self.width / self.itemsPerRow - 5; // subtract margins
          self.itemHeight = self.height/(self.items.length / self.itemsPerRow)- 6; // subtract margins (an extra pixel inheriting from browser?)
        },
        reset: function() {
          var self = this;
          
        },
        animate: function() {
          var self = this;
          document.timeline.play(self.zoomAnimation(self.countdown, self.animationSpeed*1000));
          
        }
      });

  </script>


</polymer-element>